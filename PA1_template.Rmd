---
title: "Activity Monitoring"
author: "Nathi"
output: html_document
---
The following data analysis will be carried out on data obtained from an individual's
personal activity monitoring device. The data can be obtained [here](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip).  

## **1. Loading and Reading the Data**

### Downloading the Data
The data can be downloaded to the desired directory using the following R commands:
 ```{r Downloading, cache=TRUE}
 if(!file.exists("./Data")){dir.create("./Data")}
 fileURL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
 download.file(fileURL, destfile = "./Data/activity.zip")
 ```
 
### Reading the Data
 The function `read.csv()` is then used to read the data file and store it in the variable *activityData*
```{r Reading}
activityData <- read.csv("./Data/activity.csv", stringsAsFactors = FALSE)
```

Lets take a look at the data using `str()` function
```{r}
str(activityData)
```

The class of the **date** variable is set as character. It would be more convenient to convert it to 
a date class using `as.POSIXct` function as follows:
```{r}
activityData$date <- as.POSIXct(activityData$date, "%Y-%m-%d")
```  

## **2. Calculating the Mean Total Number of Steps Taken Per Day**

### Calculating the Total Steps Per Day
In order to calculate the total steps per day, the variable *steps* has to be grouped by the variable *date* using the `group_by()`. To find the sum, `summarise()` function is used as shown. These function are available in the dplyr package.
```{r Sum, warning=FALSE, message=FALSE}
library(dplyr)
totalSteps <- activityData %>% group_by(date) %>% summarise(Total.Steps = sum(steps, na.rm = TRUE))
head(totalSteps)
```

### Creating a Histogram of Total Steps Per Day
An histogram is a plot of the frequency of occurrence of certain values. In order to plot the number of steps taken per day, we will first create a vector of dates whereby the number of occurrence of each date corresponds to the number of steps taken. This is achieved by using `rep()` function.  
Once this is done, a histogram is made using `hist()` function as follows.
```{r plot}
datefreq <- with(totalSteps, rep(date, Total.Steps))
hist(datefreq, breaks = "day", freq = TRUE, col = "skyblue", xlab = "Date",ylab = "Steps", main = "Steps per Day", format = "%d/%m")
```

### Calculating Mean and Median of the Total Steps per Day
The mean value can be calculated using `mean()` function.
```{r mean}
mean(totalSteps$Total.Steps, na.rm = TRUE)
```
The median value can be calculated using the `median()` function.
```{r median}
median(totalSteps$Total.Steps, na.rm = TRUE)
```
## **3. Average Daily Activity  Pattern**
Here we group the data with respect to the measurement intervals, calculate the mean steps for each interval and then use the results to plot a line graph.
```{r, warning=FALSE, message=FALSE}
intervalSteps <- activityData %>% group_by(interval) %>% summarise(Avg = mean(steps, na.rm = TRUE))
```
As the interval is not given in seconds but given in a format combining hours and minutes, we will have to add a new variable which reflects the change in interval more accurately.
```{r time}
intervalSteps$hours <- intervalSteps$interval %/% 100
intervalSteps$mins <- intervalSteps$interval %% 100
intervalSteps$time <- with(intervalSteps, paste(hours, ":", mins, sep = ""))
intervalSteps$time <- as.POSIXct(intervalSteps$time, format = "%H:%M")
```
Finally, the plot!
```{r}
with(intervalSteps, plot(time, Avg, type = "l", col = "blue", xlab = "Time", ylab = "Steps", main = "Average Daily Activity Pattern"))
```

By arranging the data set in descending order of average steps and taking the first value of the variable interval, we get the interval at which the maximum average step occurs.
```{r maxStep}
maxStep <- max(intervalSteps$Avg)
intervalSteps <- arrange(intervalSteps, desc(Avg))
maxInterval <- intervalSteps$interval[1]
print(maxInterval)
```
The maximum average step of **`r maxStep`** occurs at an interval of **`r maxInterval`**.